{"version":3,"sources":["main-menu-backend.js","backend.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"backend.js","sourcesContent":["// Fuente: https://webdesign.tutsplus.com/tutorials/orman-clarks-vertical-navigation-menu-the-css3-version--webdesign-5944\n\n$(document).ready(function(e) {\n    var menu_ul = $('.menu > li > ul'),\n        menu_a  = $('.menu > li > a');\n\n    function activeMenu (regExp, findIn) {\n        for (var i = findIn.length - 1; i >= 0; i--) {\n            var a = findIn[i];\n            var t = findIn[i].text;\n            if(regExp.test(t.toLowerCase())) {\n                $(a).addClass('active').next().stop(true,true).slideDown('normal');\n            }\n        }\n    }\n\n    path = window.location.pathname;\n    path = path.split('/');\n    path.shift();\n\n    menu_ul.hide();\n\n    if(/cottages/.test(path)) {\n        activeMenu(/cabañas/, menu_a);\n        (path[2]) ? null : $('#main_content').removeClass('col-md-4').addClass('col-md-6');\n        (/create/.test(path) || /edit/.test(path)) ? $('.panel').addClass('form-panel') : null;\n    } else if (/users/.test(path)) {\n        activeMenu(/usuarios/, menu_a);\n        $('#main_content').removeClass('col-md-4').addClass('col-md-6');\n    } else if (/frontend/.test(path)) {\n        activeMenu(/página principal/, menu_a);\n        $('#main_content').removeClass('col-md-4').addClass('col-md-6');\n    }\n\n\n    menu_a.click(function(e) {\n        e.preventDefault();\n        if(!$(this).hasClass('active')) {\n            menu_a.removeClass('active');\n            menu_ul.filter(':visible').slideUp('normal');\n            $(this).addClass('active').next().stop(true,true).slideDown('normal');\n        } else {\n            $(this).removeClass('active');\n            $(this).next().stop(true,true).slideUp('normal');\n        }\n    });\n});","$(document).ready(function(e) {\n    /***********************************************************************************\n    * Funciones útiles para trabajar con JavaScript\n    * ---------------------------------------------------------------\n    *\n    *  Si no existe crea una funcion para determinar si es un Objeto.\n    **/\n    if (!Object.isObject) {\n        Object.isObject = function(arg) {\n            return Object.prototype.toString.call(arg) === '[object Object]';\n        };\n    }\n    /**\n     *  Si no existe crea una funcion para determinar si es un Array.\n     **/\n    if (!Array.isArray) {\n        Array.isArray = function(arg) {\n            return Object.prototype.toString.call(arg) === '[object Array]';\n        };\n    }\n\n    /***********************************************************************************\n     * Funciones necesarias la funcionalidad del backend siguiendo el principio DRY\n     * ------------------------------------------------------------------------------\n     *\n     *  This function remove image from input value\n     *  @param $this - jQuery element - Element that will be removed and added.\n     *  @param $removeTo - jQuery element - Element of which $this will be removed.\n     *  @param $addTo - jQuery element - Element in which $this will be added.\n     * *********************************************************************************/\n    function removeAddFromInputValue($this, $removeTo, $addTo) {\n        // elimina la imagen de $removeTo\n        var images = $removeTo.val();\n        images = images.split('|');\n        images.pop();\n        for (var i = images.length - 1; i >= 0; i--) {\n            if(images[i] === $this.attr('alt')) {\n                images.splice(i--, 1);\n                break;\n            }\n        }\n        if (images.length > 0) {\n            images = images.join('|') + '|';\n        }\n        $removeTo.val(images);\n        // agrega la imagen a $addTo\n        $addTo.val($addTo.val() + $this.attr('alt') + '|');\n    }\n    /*****************************************************************************************************************\n     *  Function to set modals with forms\n     *  ---------------------------------\n     *  @param $this Objec jQuery - Boton que llama al modal y del cual se tama la clase.\n     *  @param method - string - El metodo del formulario POST, PUT, etc.\n     *  @param files - boolean or string - Indica si el form sube archivos, pude contener 'multipart/form-data'\n     *  @param replaceInAction - string - String con que se reemplazará el texto subdir en el atributo action del form.\n     *  @param textsToDisplay - Object or Array - Debe contener los textos a cargar en el modal.\n     *         Con los siguientes indices o atributos:\n     *         name - boolean -> indica si se mostrara en el título el nombre del objeto a modificar o el atributo que se modificará.\n     *         tile - string -> El texto que se mostrará en el título del modal.\n     *         infoText - string -> Texto que se mostrará en la etiqueta small dentro del titulo del modal.\n     *         label - string -> Texto que se mostrará en la etiqueta label y en el div con clase input-group-addon.\n     *         textBtn string -> Texto que se mostrará en el boton que envía el formulario.\n     *         inputType - string -> Texto que define el atributo type del input del formulario.\n     *         options - Array de Objects -> Array que se utilizará para crear las etiquetas options si el input es de\n     *                   tipo select debe definir las propiedades value y text. Por ejemplo:\n     *                   options: [\n     *                              {value: 'valueOption', text: 'textOption'},\n     *                              {value: 'valueOption', text: 'textOption'},\n     *                              ...\n     *                            ]\n     *  @param modalSize - string - Clase para el tamaño del modal, modal-sm o modal-lg.\n     *  @param $formOptional - Object jQuery or string - Objeto jQuery que contiene el form a configurar o texto que\n     *         define el id del form a configurar.\n     * ****************************************************************************************************************/\n    function setModalForms($this, method, files, replaceInAction, textsToDisplay, modalSize, $formOptional) {\n        var $row = $this.parents('tr');\n        var id = $row.data('object');\n        var inputValue = $this.data('objectValue');\n        var name = $this.data('objectDisplay');\n        var $btnSubmit = $('#submit_form');\n        var $btnClose = $('.modal-footer > button.btn-default');\n        var $form = ($formOptional !== '' && $formOptional !== undefined && $formOptional !== null) ? $formOptional : $('#modalFormId');\n        if (!Object.isObject(textsToDisplay)) {\n            var message = (''+\n                'El quinto parametro de la función debe ser un array de objetos y debe contener las siguientes propiedades:\\n' +\n                'name - boolean -> indica si se mostrara en el título el nombre del objeto a modificar o el atributo que se modificará.\\n' +\n                'tile - string -> El texto que se mostrará en el título del modal.\\n' +\n                'infoText - string -> Texto que se mostrará en la etiqueta small dentro del titulo del modal.\\n' +\n                'label - string -> Texto que se mostrará en la etiqueta label y en el div con clase input-group-addon.\\n' +\n                'textBtn string -> Texto que se mostrará en el boton que envía el formulario.\\n' +\n                'inputType - string -> Texto que define el atributo type del input del formulario.\\n' +\n                'options - Array de Objects -> Array que se utilizará para crear las etiquetas options si el input es de\\n' +\n                'tipo select debe definir las propiedades value y text. Por ejemplo:\\n' +\n                'options: [                                                         \\n' +\n                '            {value: \\'valueOption\\', text: \\'textOption\\'},        \\n' +\n                '            {value: \\'valueOption\\', text: \\'textOption\\'},        \\n' +\n                '            ...                                                    \\n' +\n                '         ]                                                         \\n');\n            console.log(message);\n            window.alert('Ver mensaje en consola');\n            return;\n        }\n        if (Object.isObject(textsToDisplay)) {\n            $('.modal-title').html('¿ ' + textsToDisplay.title + ' <span class=\"span-display label\"></span> ? <br /> <small>' + textsToDisplay.infoText + '</small>');\n            $('.sr-only, .input-group-addon').text(textsToDisplay.label);\n        }\n        if (modalSize !== '' && modalSize !== undefined && modalSize !== null) {\n            $('.modal-dialog').addClass(modalSize);\n        }\n        $('.span-display').html('<i class=\"fa fa-hashtag\" aria-hidden=\"true\"></i> ' + (textsToDisplay.name) ? name : inputValue);\n        if (textsToDisplay.inputType.toLowerCase() === 'select') {\n            $('#inputFormId').remove();\n            $('.input-group').append($('<select>').attr('id', 'inputFormId').attr('name', 'inputFormId').addClass('form-control'));\n            if (Array.isArray(textsToDisplay.options)) {\n                $.each(textsToDisplay.options, function (i, item) {\n                    $('#inputFormId').append($('<option>', {\n                        value: item.value,\n                        text: item.text\n                    }));\n                });\n                $('#inputFormId').val(inputValue);\n            } else {\n                console.log(message)\n            }\n        } else {\n            $('#inputFormId').remove();\n            $('.input-group').append($('<input>').attr('id', 'inputFormId').attr('name', 'inputFormId').addClass('form-control'));\n            $('#inputFormId').attr('type', textsToDisplay.inputType).val(inputValue);\n        }\n        if (method.toUpperCase() === 'DELETE') {\n            $('#inputFormId').attr('disabled', 'disabled');\n            $('.span-display').addClass('label-danger');\n            $('.modal-title > small').addClass('text-danger');\n            $btnSubmit.removeClass('btn-primary').addClass('btn-danger');\n            $btnSubmit.html('<i class=\"fa fa-trash-o\" aria-hidden=\"true\"></i> ' + textsToDisplay.textBtn);\n        } else {\n            $('#inputFormId').removeAttr('disabled');\n            $('.span-display').addClass('label-warning');\n            $('.modal-title > small').addClass('text-warning');\n            $btnSubmit.removeClass('btn-primary').addClass('btn-warning');\n            $btnSubmit.html('<i class=\"fa fa-exchange\" aria-hidden=\"true\"></i> ' + textsToDisplay.textBtn);\n        }\n        $('input[name=_method]').val(method.toUpperCase());\n        (typeof(files) === \"boolean\") ? ((files) ? $form.attr('enctype', 'multipart/form-data'): null) : $form.attr('enctype', files);\n        var oldAction = $form.attr('action');\n        var action = oldAction.replace('subdir', replaceInAction).replace('{id}', id);\n        $form.attr('action', action);\n        $btnSubmit.click(function () {\n            var data = $form.serialize();\n            var url = $form.attr('action');\n            $('#modalForms').hide();\n            if (method.toLowerCase() === 'delete') {\n                $('#inputFormId').removeAttr('disabled');\n                $.post(url, data, function (response) {\n                    $row.fadeOut();\n                });\n            } else {\n                $form.submit();\n            }\n        });\n        $('#modalForms').on('hide.bs.modal', function (e) {\n            $form.attr('action', oldAction);\n        })\n    }\n\n\n    /*********************************************************************\n     * Funcionalidad y comportamientos del Backend del sitio.\n     * --------------------------------------------------------\n     *\n     * Info helpers in forms\n     *\n     *******************************************/\n    var icons = $('.help-info > .help-icon');\n    var texts = $('.help-info > .help-text');\n\n    texts.hide();\n\n    icons.click(function(event) {\n        event.preventDefault();\n        $(this).next().fadeToggle('slow', 'linear');\n    });\n\n    /************************************************************************************\n     *  Detecta si hay algo en el input hiden de imagenes que se eliminarán y agrega\n     *  la clase correspondiente.\n     * **********************************************************************************/\n    if($('#removedImages').val() !== '' && $('#removedImages').val() !== undefined) {\n        var removed = $('#removedImages').val();\n        if(removed !== '') {\n            removed = removed.split('|');\n        }\n        removed.pop();\n        var images = $('.img-clickable');\n        for (var i = images.length - 1; i >= 0; i--) {\n            for (var j = removed.length - 1; j >= 0; j--) {\n                if(images[i] === removed[j]) {\n                    images[i].addClass('img-clicked');\n                }\n            }\n        }\n    }\n\n    /**************************************************************************\n     *  Añade la clase img-clicked a las imágenes seleccionadas y agrega el\n     *  nombre de la imágen al input removedImages para ser eliminadas al\n     *  enviar el form.\n     * *************************************************************************/\n    $('.img-clickable').click(function (event) {\n        event.preventDefault();\n        if ($(this).hasClass('img-clicked')) {\n            $(this).removeClass('img-clicked');\n            removeAddFromInputValue($(this), $('#removedImages'), $('#actualImages'));\n        } else {\n            $(this).addClass('img-clicked');\n            removeAddFromInputValue($(this), $('#actualImages'), $('#removedImages'));\n        }\n    })\n\n    /******************************************************************\n     *  Button delete Cottage\n     * *****************************************************************/\n    $('.delete-cottage').click(function (event) {\n        texts = {\n            name: false,\n            title : 'Esta seguro que desea eliminar la cabaña',\n            infoText: 'Esto eliminará permanentemente la cabaña de la base de datos.',\n            label: 'Eliminar cabaña',\n            textBtn: 'Eliminar cabaña',\n            inputType: 'number',\n            options: ''\n        };\n        setModalForms($(this), 'DELETE', false, 'cottages', texts);\n    });\n\n    /******************************************************************\n     *  Button edit type User\n     * *****************************************************************/\n    $('.btn-edit-type').click(function (event) {\n        texts = {\n            name: true,\n            title : 'Esta seguro que desea cambiar el rol del usuario',\n            infoText: 'Esto pude dar mayor acceso al sistema a dicho usuario.',\n            label: 'Roles',\n            textBtn: 'Actualizar rol',\n            inputType: 'select',\n            options: [\n                {value: 'frecuente', text: 'Frecuente'},\n                {value: 'empleado', text: 'Empleado'},\n                {value: 'administrador', text: 'Administrador'},\n                {value: 'sysadmin', text: 'Sysadmin'}\n            ]\n        };\n        setModalForms($(this), 'PUT', false, 'users', texts);\n    });\n\n    /******************************************************************\n     *  Button edit type User\n     * *****************************************************************/\n    $('.btn-delete-user').click(function (event) {\n        texts = {\n            name: true,\n            title : 'Esta seguro que desea eliminar al usuario',\n            infoText: 'Esto eliminará permanentemente el usuario de la base de datos.',\n            label: 'Eliminar a',\n            textBtn: 'Eliminar usuario',\n            inputType: 'text',\n            options: ''\n        };\n        setModalForms($(this), 'DELETE', false, 'users', texts);\n    });\n\n    /******************************************************************\n     *  Menú pegajoso\n     * *****************************************************************/\n    $(document).ready(function(){\n        var altura = $('.general-menu').offset().top;\n\n        $(window).on('scroll', function(){\n            if ( $(window).scrollTop() > altura ){\n                $('.general-menu').addClass('menu-fixed');\n                $('#main_menu, #main_content').css('margin-top', '50px');\n            } else {\n                $('.general-menu').removeClass('menu-fixed');\n                $('#main_menu, #main_content').removeAttr('style');\n            }\n        });\n\n    });\n});"]}